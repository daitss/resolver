<?xml version = "1.0" encoding="UTF-8"?>
<premis xmlns="http://www.loc.gov/premis/v3">
  
  <event>
    <eventIdentifier>
      <eventIdentifierType>URI</eventIdentifierType>
      <eventIdentifierValue><%= @event_id %></eventIdentifierValue>
    </eventIdentifier>
    <eventType>XML Resolution</eventType>
    <eventDateTime><%= Time.now.xmlschema %></eventDateTime>
    <eventOutcomeInformation>
      <eventOutcome><%= @outcome %></eventOutcome>
      <%unless @broken_links.nil? or @broken_links.empty? %>
      <eventOutcomeDetail>
        <eventOutcomeDetailExtension>
          <% @broken_links.each do |link, ext| %>
          <broken_link type="<%= ext[0] %>"><%= link %></broken_link>
          <% end %>
        </eventOutcomeDetailExtension>
      </eventOutcomeDetail>
      <% end %>
    </eventOutcomeInformation>
    <linkingAgentIdentifier>
      <linkingAgentIdentifierType>URI</linkingAgentIdentifierType>
      <linkingAgentIdentifierValue>info:fda/daitss/resolver/v<%= RESOLVER_VERSION %></linkingAgentIdentifierValue>
    </linkingAgentIdentifier>
    <linkingObjectIdentifier>
      <linkingObjectIdentifierType>URI</linkingObjectIdentifierType>
      <linkingObjectIdentifierValue><%= @event_id %></linkingObjectIdentifierValue>
    </linkingObjectIdentifier>
  </event>
  
  <agent>
    <agentIdentifier>
      <agentIdentifierType>URI</agentIdentifierType>
      <agentIdentifierValue>info:fda/daitss/resolver/v<%= RESOLVER_VERSION %></agentIdentifierValue>
    </agentIdentifier>
    <agentName>daitss resolver service (Version <%= RESOLVER_VERSION %>)</agentName>
    <agentType>web service</agentType>
  </agent>

</premis>
